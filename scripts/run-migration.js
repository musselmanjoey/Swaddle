// Database Migration Runner\n// Run the playlist enhancer migration to add new tables and functions\n\nconst { Pool } = require('pg');\nconst fs = require('fs');\nconst path = require('path');\n\n// Load environment variables\nrequire('dotenv').config({ path: path.join(__dirname, '../.env.local') });\n\nasync function runMigration() {\n  const pool = new Pool({\n    host: process.env.DB_HOST || 'localhost',\n    port: process.env.DB_PORT || 5432,\n    database: process.env.DB_NAME || 'swaddle',\n    user: process.env.DB_USER || 'postgres',\n    password: process.env.DB_PASSWORD || ''\n  });\n\n  try {\n    console.log('ğŸš€ [MIGRATION] Starting Playlist Enhancer migration...');\n    \n    // Read migration file\n    const migrationPath = path.join(__dirname, '../src/database/migrations/002_playlist_enhancer.sql');\n    const migrationSQL = fs.readFileSync(migrationPath, 'utf8');\n    \n    console.log('ğŸ“„ [MIGRATION] Migration file loaded');\n    \n    // Execute migration\n    await pool.query(migrationSQL);\n    \n    console.log('âœ… [MIGRATION] Playlist Enhancer migration completed successfully!');\n    console.log('ğŸ“Š [MIGRATION] New tables created:');\n    console.log('   - enhanced_playlists');\n    console.log('   - genius_song_data');\n    console.log('   - playlist_enhancement_sessions');\n    console.log('ğŸ”§ [MIGRATION] New functions and views created');\n    \n    // Verify tables were created\n    const result = await pool.query(`\n      SELECT table_name \n      FROM information_schema.tables \n      WHERE table_schema = 'public' \n        AND table_name IN ('enhanced_playlists', 'genius_song_data', 'playlist_enhancement_sessions')\n      ORDER BY table_name\n    `);\n    \n    console.log('ğŸ” [MIGRATION] Verification - Tables found:');\n    result.rows.forEach(row => {\n      console.log(`   âœ“ ${row.table_name}`);\n    });\n    \n    if (result.rows.length === 3) {\n      console.log('ğŸ‰ [MIGRATION] All tables created successfully!');\n    } else {\n      console.log('âš ï¸ [MIGRATION] Some tables may not have been created properly');\n    }\n    \n  } catch (error) {\n    console.error('âŒ [MIGRATION] Migration failed:', error.message);\n    console.error('ğŸ“ [MIGRATION] Error details:', error);\n    process.exit(1);\n  } finally {\n    await pool.end();\n    console.log('ğŸ”’ [MIGRATION] Database connection closed');\n  }\n}\n\n// Run migration if called directly\nif (require.main === module) {\n  runMigration().catch(console.error);\n}\n\nmodule.exports = runMigration;